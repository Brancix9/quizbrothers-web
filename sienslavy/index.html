<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sie≈à sl√°vy - QuizBrothers</title>
    <link rel="stylesheet" href="../style.css">
    <link rel="icon" href="../favicon.webp" type="image/webp">
    <style>
        /* ≈†pecifick√© ≈°t√Ωly pre p√≥dium, ktor√© v style.css nem√°≈° */
        .podium-container {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        .podium-place {
            background: white;
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            flex: 1;
            min-width: 200px;
            position: relative;
            transition: all 0.3s ease;
            border-top: 4px solid #ddd;
        }
        
        .place-1 { 
            order: 2; 
            border-top-color: #d4af37;
            transform: scale(1.08);
            z-index: 2;
            box-shadow: 0 10px 40px rgba(0,0,0,0.12);
        }
        
        .place-1 h3 {
            color: #222454;
            font-weight: 600;
        }
        
        .place-2 { 
            order: 1; 
            border-top-color: #8a8a8a;
            box-shadow: 0 6px 25px rgba(0,0,0,0.08);
        }
        
        .place-2 h3 {
            color: #222454;
            font-weight: 600;
        }
        
        .place-3 { 
            order: 3; 
            border-top-color: #b87333;
            box-shadow: 0 6px 25px rgba(0,0,0,0.08);
        }
        
        .place-3 h3 {
            color: #222454;
            font-weight: 600;
        }
        
        .podium-place:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(0,0,0,0.15);
        }
        
        .place-1:hover {
            transform: translateY(-3px) scale(1.08);
        }
        
        .podium-place img {
            width: 100%;
            height: 250px;
            object-fit: contain;
            border-radius: 5px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .podium-place img:hover { transform: scale(1.05); }
        .medal { 
            font-size: 2.5rem; 
            display: block; 
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
        }
        
        /* Tabuƒæka celkov√©ho poradia */
        .standings-table {
            width: 100%;
            max-width: 700px;
            margin: 40px auto;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        .standings-table th {
            background: #222454;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        .standings-table th:first-child {
            width: 60px;
            text-align: center;
        }
        .standings-table th:last-child {
            width: 100px;
            text-align: right;
        }
        .standings-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #f0f0f0;
        }
        .standings-table td:first-child {
            text-align: center;
            font-weight: 600;
            color: #666;
        }
        .standings-table td:last-child {
            text-align: right;
            font-weight: 600;
            color: #27ae60;
        }
        .standings-table tr:hover {
            background: #f8f9fa;
        }
        .standings-table tr:last-child td {
            border-bottom: none;
        }
        .standings-table tr.top-3 {
            background: #f9f9f9;
        }
        .standings-table tr.top-3 td:first-child {
            font-size: 1.1em;
        }
        .standings-table tr:nth-child(2) td:first-child { color: #d4af37; }
        .standings-table tr:nth-child(3) td:first-child { color: #8a8a8a; }
        .standings-table tr:nth-child(4) td:first-child { color: #b87333; }
        
        /* Admin tlaƒçidl√° pre tabuƒæku */
        .standings-admin-controls {
            text-align: center;
            margin-top: 15px;
            display: none;
        }
        .standings-admin-controls.show {
            display: block;
        }
        .standings-admin-controls button {
            background: #27ae60;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            margin: 0 5px;
        }
        .standings-admin-controls button:hover {
            background: #229954;
        }
        .standings-table tbody tr.admin-mode {
            position: relative;
        }
        .standings-table tbody tr.admin-mode td {
            cursor: text;
        }
        .standings-table tbody tr.admin-mode .row-delete {
            position: absolute;
            right: -35px;
            top: 50%;
            transform: translateY(-50%);
            background: #e74c3c;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 16px;
            display: none;
        }
        .standings-table tbody tr.admin-mode:hover .row-delete {
            display: block;
        }
        .standings-table tbody tr.admin-mode .row-delete:hover {
            background: #c0392b;
        }
        .standings-table-wrapper {
            position: relative;
        }
        
        /* Carousel gal√©ria pre momentky */
        .gallery-carousel {
            position: relative;
            margin-top: 20px;
            overflow: hidden;
        }
        .gallery-track {
            display: flex;
            gap: 10px;
            transition: transform 0.3s ease;
        }
        .gallery-track img {
            flex: 0 0 calc(33.333% - 7px);
            height: 200px;
            object-fit: contain;
            border-radius: 5px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .gallery-track img:hover { transform: scale(1.05); }
        
        .carousel-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.9);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            z-index: 10;
        }
        .carousel-btn:hover { background: #fff; }
        .carousel-btn.prev { left: 10px; }
        .carousel-btn.next { right: 10px; }
        
        .gallery-counter {
            text-align: center;
            margin-top: 10px;
            color: #666;
            font-size: 14px;
        }
        
        @media (max-width: 768px) {
            .gallery-track img {
                flex: 0 0 100%;
                height: 250px;
            }
        }
        
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }
        .gallery-grid img {
            cursor: pointer;
            transition: transform 0.2s;
            border-radius: 5px;
        }
        .gallery-grid img:hover { transform: scale(1.05); }

        /* Modal pre zv√§ƒç≈°enie obr√°zkov */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.9);
            justify-content: center;
            align-items: center;
        }
        .modal.show { display: flex; }
        .modal-content {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
        }
        .modal-close {
            position: absolute;
            top: 20px;
            right: 40px;
            color: #fff;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
        }
        .modal-close:hover { color: #ccc; }
        
        .modal-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.8);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 24px;
            color: #222454;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1001;
        }
        .modal-nav:hover { background: rgba(255,255,255,1); }
        .modal-nav.modal-prev { left: 20px; }
        .modal-nav.modal-next { right: 20px; }
        
        /* Admin tlaƒçidl√° pre tabuƒæku */
        .standings-admin-controls {
            text-align: center;
            margin-top: 15px;
            display: none;
        }
        .standings-admin-controls.show {
            display: block;
        }
        .standings-admin-controls button {
            background: #27ae60;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            margin: 0 5px;
        }
        .standings-admin-controls button:hover {
            background: #229954;
        }
        .standings-table tbody tr.admin-mode {
            position: relative;
        }
        .standings-table tbody tr.admin-mode td[contenteditable] {
            cursor: text;
            background: #fffde7;
        }
        .standings-table tbody tr.admin-mode .row-delete {
            position: absolute;
            right: -35px;
            top: 50%;
            transform: translateY(-50%);
            background: #e74c3c;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 16px;
            display: none;
        }
        .standings-table tbody tr.admin-mode:hover .row-delete {
            display: block;
        }
        .standings-table tbody tr.admin-mode .row-delete:hover {
            background: #c0392b;
        }
        .standings-table-wrapper {
            position: relative;
        }
        
        /* Admin tlaƒçidl√° pre pridanie sez√≥ny */
        .add-season-btn {
            display: none;
            text-align: center;
            margin: 20px 0;
        }
        .add-season-btn.show {
            display: block;
        }
        .add-season-btn button {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
            transition: all 0.3s ease;
        }
        .add-season-btn button:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        .delete-season-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .delete-season-btn:hover {
            background: #c0392b;
            transform: scale(1.05);
        }

        .season-card {
            margin-bottom: 60px;
        }

        .collapsible-header {
            cursor: pointer;
            user-select: none;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 30px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .collapsible-header:hover {
            background: #e9ecef;
        }

        .collapsible-header .toggle-icon {
            font-size: 20px;
            transition: transform 0.3s ease;
        }

        .collapsible-header.collapsed .toggle-icon {
            transform: rotate(-90deg);
        }

        .collapsible-content {
            max-height: 2000px;
            overflow: hidden;
            transition: max-height 0.4s ease;
        }

        .collapsible-content.collapsed {
            max-height: 0;
        }

        @media (max-width: 768px) {
            .place-1 { order: 1; transform: none; }
            .place-2 { order: 2; }
            .place-3 { order: 3; }
            .podium-container { flex-direction: column; align-items: stretch; }
        }
    </style>
</head>
<body>

    <header>
        <div class="nav-container">
            <a href="../" class="logo">
                <img src="../logo.png" alt="QuizBrothers Logo">
                <span>Quiz<span>Brothers</span></span>
            </a>
            <div class="menu-toggle" onclick="toggleMenu()">‚ò∞</div>
            <nav>
                <ul id="nav-list">
                    <li><a href="../">Domov</a></li>
                    <li><a href="../rezervacia/">Rezerv√°cia stola</a></li>
                    <li><a href="../aplikacia/">Aplik√°cia</a></li>
                    <li><a href="../sienslavy/" class="active">Sie≈à sl√°vy</a></li>
                    <li><a href="../onas/">O n√°s</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="container">
        <h1 style="text-align: center;" id="hall_of_fame_title">üèÜ Sie≈à sl√°vy</h1>
        <p style="text-align: center; margin-bottom: 40px;" id="hall_of_fame_subtitle">Prehƒæad v√≠≈•azov a najlep≈°√≠ch momentov z na≈°ich sez√≥n.</p>

        <!-- Admin tlaƒçidlo pre pridanie sez√≥ny hore -->
        <div class="add-season-btn" id="addSeasonTop">
            <button onclick="addNewSeason('up')">‚ûï Prida≈• nov≈°iu sez√≥nu</button>
        </div>

        <!-- Kontajner pre dynamick√© sez√≥ny -->
        <div id="seasonsContainer">
            <!-- Sez√≥ny sa generuj√∫ dynamicky -->
        </div>

        <!-- Admin tlaƒçidlo pre pridanie sez√≥ny dole -->
        <div class="add-season-btn" id="addSeasonBottom">
            <button onclick="addNewSeason('down')">‚ûï Prida≈• star≈°iu sez√≥nu</button>
        </div>

    </div>

    <script>
        // ========== SEASONS MANAGEMENT ==========
        
        // Vytvorenie HTML pre jednu sez√≥nu
        function createSeasonHTML(year) {
            return `
                <div class="card season-card" data-year="${year}" style="text-align: left;">
                    <h2 style="border-bottom: 2px solid #27ae60; padding-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
                        <span>Sez√≥na ${year}</span>
                        <button class="delete-season-btn" id="deleteSeason_${year}" onclick="deleteSeason('${year}')" style="display: none;">üóëÔ∏è Odstr√°ni≈• sez√≥nu</button>
                    </h2>
                    
                    <div class="podium-container">
                        <div class="podium-place place-2">
                            <span class="medal">ü•à</span>
                            <img src="${year}/2miesto.webp" alt="2. miesto" onclick="openModal(this.src)" onerror="this.style.display='none'">
                            <h3 contenteditable="false" class="editable-text">2. miesto</h3>
                            <p style="font-weight: bold; margin-top: 5px; font-size: 18px;" contenteditable="false" class="editable-text" id="team2_${year}"></p>
                        </div>
                        <div class="podium-place place-1">
                            <span class="medal">üëë</span>
                            <img src="${year}/1miesto.webp" alt="1. miesto" onclick="openModal(this.src)" onerror="this.style.display='none'">
                            <h3 contenteditable="false" class="editable-text">1. miesto</h3>
                            <p style="font-weight: bold; margin-top: 5px; font-size: 18px;" contenteditable="false" class="editable-text" id="team1_${year}"></p>
                        </div>
                        <div class="podium-place place-3">
                            <span class="medal">ü•â</span>
                            <img src="${year}/3miesto.webp" alt="3. miesto" onclick="openModal(this.src)" onerror="this.style.display='none'">
                            <h3 contenteditable="false" class="editable-text">3. miesto</h3>
                            <p style="font-weight: bold; margin-top: 5px; font-size: 18px;" contenteditable="false" class="editable-text" id="team3_${year}"></p>
                        </div>
                    </div>

                    <h4 class="collapsible-header collapsed" onclick="toggleCollapse('standings_${year}')">
                        <span class="toggle-icon">‚ñº</span>
                        üèÜ Celkov√© poradie sez√≥ny ${year}
                    </h4>
                    <div class="collapsible-content collapsed" id="standings_${year}">
                        <div class="standings-table-wrapper">
                            <table class="standings-table" id="standingsTable_${year}">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>N√°zov t√≠mu</th>
                                        <th>Body</th>
                                    </tr>
                                </thead>
                                <tbody id="standingsTableBody_${year}">
                                    <tr><td colspan="3" style="text-align: center; padding: 20px; color: #999;">≈Ωiadne d√°ta</td></tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="standings-admin-controls" id="standingsAdminControls_${year}">
                            <button onclick="addStandingsRow('${year}')">‚ûï Prida≈• t√≠m</button>
                            <button onclick="saveStandings('${year}')">üíæ Ulo≈æi≈• zmeny</button>
                        </div>
                    </div>

                    <h4 class="collapsible-header collapsed" onclick="toggleCollapse('gallery_${year}')">
                        <span class="toggle-icon">‚ñº</span>
                        üì∏ Momentky zo sez√≥ny
                    </h4>
                    <div class="collapsible-content collapsed" id="gallery_${year}">
                        <div class="gallery-carousel">
                            <button class="carousel-btn prev" onclick="moveCarousel('${year}', -1)">‚Äπ</button>
                            <button class="carousel-btn next" onclick="moveCarousel('${year}', 1)">‚Ä∫</button>
                            <div class="gallery-track" id="galleryTrack_${year}">
                                ${generateGalleryImages(year)}
                            </div>
                        </div>
                        <div class="gallery-counter" id="galleryCounter_${year}"></div>
                    </div>
                </div>
            `;
        }

        // Generovanie obr√°zkov gal√©rie
        function generateGalleryImages(year) {
            let html = '';
            for (let i = 1; i <= 17; i++) {
                html += `<img src="${year}/foto${i}.webp" alt="Foto ${i}" onclick="openModal(this.src)" onerror="this.style.display='none'"> `;
            }
            return html;
        }

        // Vykresli v≈°etky sez√≥ny
        window.renderSeasons = function() {
            const container = document.getElementById('seasonsContainer');
            if (!container) {
                console.error('‚ùå seasonsContainer neexistuje');
                return;
            }
            console.log('üìù Renderujem sez√≥ny:', window.currentSeasons);
            
            // Zoraƒè sez√≥ny - najprv ƒç√≠seln√©, potom textov√©
            window.currentSeasons.sort((a, b) => {
                const aNum = typeof a === 'number' ? a : parseInt(a.split('-')[0]);
                const bNum = typeof b === 'number' ? b : parseInt(b.split('-')[0]);
                return bNum - aNum; // Zostupne
            });
            
            container.innerHTML = window.currentSeasons.map(year => createSeasonHTML(year)).join('');
            
            // Vykresli tabuƒæky pre ka≈æd√∫ sez√≥nu
            window.currentSeasons.forEach(year => {
                // ≈†peci√°lne spracovanie pre COVID sez√≥nu 2020-2021
                if (year === "2020-2021") {
                    const standingsDiv = document.getElementById(`standings_${year}`);
                    console.log('ü¶† Nastavujem COVID dizajn pre 2020-2021', standingsDiv);
                    if (standingsDiv) {
                        // Najprv rozbal sekciu
                        standingsDiv.classList.remove('collapsed');
                        const header = standingsDiv.previousElementSibling;
                        if (header && header.classList.contains('collapsible-header')) {
                            header.classList.remove('collapsed');
                        }
                        
                        // Nastav COVID dizajn
                        standingsDiv.innerHTML = `
                            <div style="text-align: center; padding: 40px 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 10px; color: white;">
                                <h3 style="font-size: 28px; margin-bottom: 15px;">ü¶† COVID-19 Pand√©mia</h3>
                                <p style="font-size: 18px; line-height: 1.6; max-width: 600px; margin: 0 auto;">
                                    Kv√≠zov√° sez√≥na 2020/2021 bola preru≈°en√° kv√¥li pand√©mii koronav√≠rusu.<br>
                                    Z bezpeƒçnostn√Ωch d√¥vodov sme museli v≈°etky podujatia zru≈°i≈•.
                                </p>
                                <p style="margin-top: 20px; font-size: 16px; opacity: 0.9;">
                                    ‚è∏Ô∏è Sez√≥na preru≈°en√° ‚Ä¢ ≈Ωiadne v√Ωsledky
                                </p>
                            </div>
                        `;
                    } else {
                        console.error('‚ùå Element standings_2020-2021 sa nena≈°iel');
                    }
                    
                    // Odstr√°≈à men√° v√≠≈•azov pre COVID sez√≥nu
                    const team1 = document.getElementById(`team1_${year}`);
                    const team2 = document.getElementById(`team2_${year}`);
                    const team3 = document.getElementById(`team3_${year}`);
                    if (team1) team1.textContent = '‚Äî';
                    if (team2) team2.textContent = '‚Äî';
                    if (team3) team3.textContent = '‚Äî';
                    return;
                }
                
                // Vykresli tabuƒæku ak m√°me d√°ta
                if (window.standingsData[year]) {
                    console.log(`üìä Vykresƒæujem tabuƒæku pre rok ${year} s ${window.standingsData[year].length} t√≠mami`);
                    window.renderStandingsTable(year, window.standingsData[year], false);
                    
                    // Ak m√°me d√°ta, napl≈à v√≠≈•azov do p√≥dia
                    if (window.standingsData[year].length >= 3) {
                        const team1 = document.getElementById(`team1_${year}`);
                        const team2 = document.getElementById(`team2_${year}`);
                        const team3 = document.getElementById(`team3_${year}`);
                        
                        if (team1) team1.textContent = window.standingsData[year][0]?.name || '';
                        if (team2) team2.textContent = window.standingsData[year][1]?.name || '';
                        if (team3) team3.textContent = window.standingsData[year][2]?.name || '';
                    }
                } else {
                    console.log(`‚ö†Ô∏è ≈Ωiadne d√°ta pre rok ${year}`);
                }
            });
        }

        // Pridanie novej sez√≥ny
        window.addNewSeason = async function(direction) {
            const maxYear = Math.max(...window.currentSeasons);
            const minYear = Math.min(...window.currentSeasons);
            const newYear = direction === 'up' ? maxYear + 1 : minYear - 1;
            
            if (!window.currentSeasons.includes(newYear)) {
                window.currentSeasons.push(newYear);
                
                // Inicializuj pr√°zdne pole pre nov√∫ sez√≥nu
                if (!window.standingsData[newYear]) {
                    window.standingsData[newYear] = [];
                }
                
                window.renderSeasons();
                
                // Ulo≈æ do Firebase
                try {
                    const { doc, setDoc } = await import("https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js");
                    await setDoc(doc(window.db, "web_content", "hall_of_fame"), {
                        seasons: window.currentSeasons
                    }, { merge: true });
                    console.log('‚úÖ Sez√≥na', newYear, 'pridan√°');
                    
                    // Ak je admin re≈æim akt√≠vny, zobraz admin tlaƒçidl√° pre v≈°etky sez√≥ny
                    if (document.body.classList.contains('admin-mode')) {
                        setTimeout(() => {
                            window.currentSeasons.forEach(year => {
                                const adminControls = document.getElementById(`standingsAdminControls_${year}`);
                                if (adminControls) {
                                    adminControls.classList.add('show');
                                    console.log(`‚úÖ Admin tlaƒçidl√° zobrazen√© pre rok ${year}`);
                                }
                                // Vykresli tabuƒæku v admin re≈æime
                                if (window.standingsData[year]) {
                                    window.renderStandingsTable(year, window.standingsData[year], true);
                                }
                            });
                        }, 100);
                    }
                } catch (error) {
                    console.error('‚ùå Chyba pri ukladan√≠ sez√≥ny:', error);
                }
            }
        }

        // Odstr√°nenie sez√≥ny
        window.deleteSeason = async function(year) {
            if (!confirm(`Naozaj chce≈° odstr√°ni≈• sez√≥nu ${year}? T√°to akcia sa ned√° vr√°ti≈• sp√§≈•.`)) {
                return;
            }
            
            // Odstr√°≈à rok zo zoznamu
            const index = window.currentSeasons.indexOf(year);
            if (index > -1) {
                window.currentSeasons.splice(index, 1);
            }
            
            // Odstr√°≈à d√°ta
            delete window.standingsData[year];
            
            // Vykresli znova
            window.renderSeasons();
            
            // Ulo≈æ do Firebase
            try {
                const { doc, setDoc, deleteField } = await import("https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js");
                await setDoc(doc(window.db, "web_content", "hall_of_fame"), {
                    seasons: window.currentSeasons,
                    [`standings_${year}`]: deleteField()
                }, { merge: true });
                console.log('‚úÖ Sez√≥na', year, 'odstr√°nen√°');
                
                // Ak je admin re≈æim akt√≠vny, obnov admin tlaƒçidl√°
                if (document.body.classList.contains('admin-mode')) {
                    setTimeout(() => {
                        window.currentSeasons.forEach(y => {
                            const adminControls = document.getElementById(`standingsAdminControls_${y}`);
                            if (adminControls) adminControls.classList.add('show');
                            const deleteBtn = document.getElementById(`deleteSeason_${y}`);
                            if (deleteBtn) deleteBtn.style.display = 'inline-block';
                        });
                    }, 100);
                }
            } catch (error) {
                console.error('‚ùå Chyba pri odstra≈àovan√≠ sez√≥ny:', error);
            }
        }

        // ========== COLLAPSIBLE SECTIONS ==========
        window.toggleCollapse = function(sectionId) {
            const content = document.getElementById(sectionId);
            const header = content.previousElementSibling;
            
            content.classList.toggle('collapsed');
            header.classList.toggle('collapsed');
        }

        // ========== CAROUSEL FUNCTIONS ==========
        const carouselState = {};

        window.moveCarousel = function(year, direction) {
            if (!carouselState[year]) {
                carouselState[year] = { currentIndex: 0 };
            }
            
            const track = document.getElementById(`galleryTrack_${year}`);
            if (!track) return;
            
            const images = Array.from(track.querySelectorAll('img')).filter(img => img.style.display !== 'none');
            const totalImages = images.length;
            
            if (totalImages === 0) return;
            
            const imagesPerView = window.innerWidth <= 768 ? 1 : 3;
            const maxIndex = Math.max(0, totalImages - imagesPerView);
            
            carouselState[year].currentIndex += direction;
            if (carouselState[year].currentIndex < 0) carouselState[year].currentIndex = 0;
            if (carouselState[year].currentIndex > maxIndex) carouselState[year].currentIndex = maxIndex;
            
            const offset = -(carouselState[year].currentIndex * (100 / imagesPerView));
            track.style.transform = `translateX(${offset}%)`;
            
            const counter = document.getElementById(`galleryCounter_${year}`);
            if (counter) {
                const start = carouselState[year].currentIndex + 1;
                const end = Math.min(carouselState[year].currentIndex + imagesPerView, totalImages);
                counter.textContent = `${start}-${end} z ${totalImages}`;
            }
        }

        // ========== MODAL & GALLERY FUNCTIONS ==========
        let modalImages = [];
        let currentModalIndex = 0;

        window.openModal = function(src) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            modal.style.display = "flex";
            modalImg.src = src;
            
            // N√°jdi index aktu√°lneho obr√°zka
            modalImages = Array.from(document.querySelectorAll('.podium-place img, .gallery-track img'))
                .filter(img => img.style.display !== 'none')
                .map(img => img.src);
            currentModalIndex = modalImages.indexOf(src);
            document.body.style.overflow = 'hidden';
        }

        window.closeModal = function() {
            const modal = document.getElementById('imageModal');
            modal.style.display = "none";
            document.body.style.overflow = 'auto';
        }

        window.navigateModal = function(direction) {
            if (modalImages.length === 0) return;
            currentModalIndex = (currentModalIndex + direction + modalImages.length) % modalImages.length;
            document.getElementById('modalImage').src = modalImages[currentModalIndex];
        }

        // Klavesov√© skratky pre modal
        document.addEventListener('keydown', function(event) {
            const modal = document.getElementById('imageModal');
            if (modal.style.display === 'flex') {
                if (event.key === 'Escape') closeModal();
                if (event.key === 'ArrowLeft') navigateModal(-1);
                if (event.key === 'ArrowRight') navigateModal(1);
            }
        });

        // ========== STANDINGS TABLE ADMIN FUNCTIONALITY ==========
        // Definuj funkcie PRED Firebase naƒç√≠tan√≠m
        let isAdminLoggedIn = false;

        // Naƒç√≠tanie a vykreslenie tabuƒæky
        window.renderStandingsTable = function(year, data, adminMode = false) {
            const tbody = document.getElementById(`standingsTableBody_${year}`);
            if (!tbody) {
                console.error(`Tabuƒæka tbody pre rok ${year} nen√°jden√°!`);
                return;
            }
            
            tbody.innerHTML = '';
            
            if (!data || data.length === 0) {
                console.warn(`≈Ωiadne d√°ta na zobrazenie pre rok ${year}`);
                tbody.innerHTML = '<tr><td colspan="3" style="text-align: center; padding: 20px; color: #999;">≈Ωiadne d√°ta</td></tr>';
                return;
            }
            
            data.forEach((team, index) => {
                const row = document.createElement('tr');
                if (index < 3) row.classList.add('top-3');
                if (adminMode) row.classList.add('admin-mode');
                
                const position = index + 1;
                
                row.innerHTML = `
                    <td>${position}</td>
                    <td ${adminMode ? 'contenteditable="true"' : ''}>${team.name}</td>
                    <td ${adminMode ? 'contenteditable="true"' : ''}>${team.points}</td>
                    ${adminMode ? `<td><button class="row-delete" onclick="window.deleteStandingsRow('${year}', this)">√ó</button></td>` : ''}
                `;
                
                tbody.appendChild(row);
            });
            
            console.log(`‚úÖ Tabuƒæka pre rok ${year} vykreslen√°:`, data.length, 't√≠mov');
        }
        // Pridanie nov√©ho riadku
        window.addStandingsRow = function(year) {
            if (!window.standingsData[year]) window.standingsData[year] = [];
            window.standingsData[year].push({ name: 'Nov√Ω t√≠m', points: '0b' });
            window.renderStandingsTable(year, window.standingsData[year], true);
        }

        // Odstr√°nenie riadku
        window.deleteStandingsRow = function(year, button) {
            const row = button.closest('tr');
            const index = Array.from(row.parentElement.children).indexOf(row);
            window.standingsData[year].splice(index, 1);
            window.renderStandingsTable(year, window.standingsData[year], true);
        }

        // Ulo≈æenie zmien do Firebase
        window.saveStandings = async function(year) {
            const tbody = document.getElementById(`standingsTableBody_${year}`);
            const rows = tbody.querySelectorAll('tr');
            
            window.standingsData[year] = Array.from(rows).map((row, index) => ({
                name: row.cells[1].textContent.trim(),
                points: row.cells[2].textContent.trim()
            }));

            try {
                const { doc, setDoc } = await import("https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js");
                const fieldName = `standings_${year}`.replace(/\//g, '-');
                await setDoc(doc(window.db, "web_content", "hall_of_fame"), {
                    [fieldName]: window.standingsData[year]
                }, { merge: true });
                
                alert(`‚úÖ Poradie pre sez√≥nu ${year} bolo √∫spe≈°ne ulo≈æen√©!`);
                window.renderStandingsTable(year, window.standingsData[year], true);
            } catch (error) {
                console.error('Chyba pri ukladan√≠:', error);
                alert('‚ùå Chyba pri ukladan√≠ poradia');
            }
        }

        // Sledovanie admin m√≥du
        function checkAdminMode() {
            const isAdmin = document.body.classList.contains('admin-mode');
            
            if (isAdmin && !isAdminLoggedIn) {
                isAdminLoggedIn = true;
                // Zobraz admin tlaƒçidl√° pre v≈°etky sez√≥ny
                window.currentSeasons.forEach(year => {
                    const adminControls = document.getElementById(`standingsAdminControls_${year}`);
                    if (adminControls) adminControls.classList.add('show');
                    
                    // Zobraz tlaƒçidlo na odstr√°nenie sez√≥ny
                    const deleteBtn = document.getElementById(`deleteSeason_${year}`);
                    if (deleteBtn) deleteBtn.style.display = 'inline-block';
                    
                    if (window.standingsData[year]) {
                        window.renderStandingsTable(year, window.standingsData[year], true);
                    }
                });
                // Zobraz tlaƒçidl√° pre pridanie sez√≥n
                document.getElementById('addSeasonTop')?.classList.add('show');
                document.getElementById('addSeasonBottom')?.classList.add('show');
            } else if (!isAdmin && isAdminLoggedIn) {
                isAdminLoggedIn = false;
                // Skry admin tlaƒçidl√° pre v≈°etky sez√≥ny
                window.currentSeasons.forEach(year => {
                    const adminControls = document.getElementById(`standingsAdminControls_${year}`);
                    if (adminControls) adminControls.classList.remove('show');
                    
                    // Skry tlaƒçidlo na odstr√°nenie sez√≥ny
                    const deleteBtn = document.getElementById(`deleteSeason_${year}`);
                    if (deleteBtn) deleteBtn.style.display = 'none';
                    
                    if (window.standingsData[year]) {
                        window.renderStandingsTable(year, window.standingsData[year], false);
                    }
                });
                // Skry tlaƒçidl√° pre pridanie sez√≥n
                document.getElementById('addSeasonTop')?.classList.remove('show');
                document.getElementById('addSeasonBottom')?.classList.remove('show');
            }
        }

        // Pravideln√° kontrola admin m√≥du
        setInterval(checkAdminMode, 500);
    </script>

    <!-- Firebase Scripts -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, onSnapshot, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCgKeENYtYJWf2_DZOw4irg6GPLq3XKhEc",
            authDomain: "quizbrothers-rezervacia.firebaseapp.com",
            projectId: "quizbrothers-rezervacia",
            storageBucket: "quizbrothers-rezervacia.firebasestorage.app",
            messagingSenderId: "193476216369",
            appId: "1:193476216369:web:8e0d59dd8282cb53ba3710",
            measurementId: "G-0LKTHWLKH5"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- PREPOJENIE PRE ADMIN.JS ---
        window.app = app;
        window.db = db;
        // -------------------------------
        
        // Glob√°lne premenn√© pre sez√≥ny a √∫daje
        window.standingsData = {};
        window.currentSeasons = [2025, 2024, 2023, 2022, "2020-2021", "2019-2020", "2018-2019"];

        function loadWebContent() {
            const contentDoc = doc(db, "web_content", "hall_of_fame");
            onSnapshot(contentDoc, (docSnap) => {
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    if (data.hall_of_fame_title) document.getElementById('hall_of_fame_title').textContent = data.hall_of_fame_title;
                    if (data.hall_of_fame_subtitle) document.getElementById('hall_of_fame_subtitle').textContent = data.hall_of_fame_subtitle;
                    
                    // Ak Firebase m√° sez√≥ny, zl√∫ƒç ich s lok√°lnymi (priorita lok√°lne definovan√©)
                    if (data.seasons && Array.isArray(data.seasons)) {
                        // Pridaj Firebase sez√≥ny, ktor√© nie s√∫ v lok√°lnom zozname
                        data.seasons.forEach(season => {
                            if (!window.currentSeasons.includes(season)) {
                                window.currentSeasons.push(season);
                            }
                        });
                        
                        // Aktualizuj Firebase ak m√°me nov√© sez√≥ny
                        const hasNewSeasons = window.currentSeasons.some(s => !data.seasons.includes(s));
                        if (hasNewSeasons) {
                            console.log('üîÑ Aktualizujem zoznam sez√≥n vo Firebase');
                            setDoc(contentDoc, { seasons: window.currentSeasons }, { merge: true });
                        }
                    } else {
                        // Ak Firebase nem√° ≈æiadne sez√≥ny, ulo≈æ lok√°lne
                        console.log('üîÑ Prv√© ulo≈æenie sez√≥n do Firebase');
                        setDoc(contentDoc, { seasons: window.currentSeasons }, { merge: true });
                    }
                    
                    // Naƒç√≠taj d√°ta pre v≈°etky sez√≥ny
                    window.currentSeasons.forEach(year => {
                        const fieldName = `standings_${year}`.replace(/\//g, '-');
                        if (data[fieldName] && Array.isArray(data[fieldName]) && data[fieldName].length > 0) {
                            console.log(`üìä Naƒç√≠tan√© d√°ta pre ${year}:`, data[fieldName].length, 't√≠mov');
                            window.standingsData[year] = data[fieldName];
                        } else if (year === 2025) {
                            // Pre rok 2025 vytvor defaultn√© d√°ta ak neexistuj√∫
                            console.log('‚ö†Ô∏è ≈Ωiadne d√°ta v Firebase pre 2025, pou≈æ√≠vam defaultn√©');
                            const defaultStandings = [
                                { name: "Piƒçi Zla", points: "179b" },
                                { name: "Mu≈°ky", points: "162b" },
                                { name: "Guru Team", points: "141b" },
                                { name: "Sprost√°ci", points: "124b" },
                                { name: "Divok√© Pu≈°ky", points: "123b" },
                                { name: "F√©nixov r√°d", points: "100b" },
                                { name: "STIBU", points: "91b" },
                                { name: "≈Ωol√≠ci", points: "59b" },
                                { name: "Gen Z", points: "50b" },
                                { name: "Font√°na", points: "48b" },
                                { name: "Nev√≠dali", points: "17b" },
                                { name: "Kom√©ty", points: "7b" },
                                { name: "Gruppa ABC", points: "3b" },
                                { name: "Fantastic 5", points: "1b" }
                            ];
                            
                            window.standingsData[2025] = defaultStandings;
                            
                            // Automaticky ulo≈æ defaultn√© d√°ta do Firebase
                            setDoc(doc(db, "web_content", "hall_of_fame"), {
                                standings_2025: defaultStandings,
                                seasons: window.currentSeasons
                            }, { merge: true }).then(() => {
                                console.log('‚úÖ Defaultn√© poradie pre 2025 ulo≈æen√© do Firebase');
                            }).catch(err => {
                                console.error('‚ùå Chyba pri ukladan√≠:', err);
                            });
                        } else if (year === 2024) {
                            // Pre rok 2024 vytvor defaultn√© d√°ta ak neexistuj√∫
                            console.log('‚ö†Ô∏è ≈Ωiadne d√°ta v Firebase pre 2024, pou≈æ√≠vam defaultn√©');
                            const defaultStandings2024 = [
                                { name: "Mu≈°ky", points: "154b" },
                                { name: "Guru Team", points: "140b" },
                                { name: "Sprost√°ci", points: "115b" },
                                { name: "Divok√© Pu≈°ky", points: "105b" },
                                { name: "STIBU", points: "94b" },
                                { name: "Font√°na", points: "77b" },
                                { name: "≈Ωol√≠ci", points: "64b" },
                                { name: "V√≠-≈•a-zi", points: "24b" },
                                { name: "Tuli Tuli", points: "18b" },
                                { name: "≈†ugibanda", points: "17b" },
                                { name: "ƒåipmankovia", points: "15b" },
                                { name: "Quiztieri", points: "7b" },
                                { name: "Piƒçi Zla", points: "7b" },
                                { name: "Old School", points: "3b" },
                                { name: "KGB", points: "1b" }
                            ];
                            
                            window.standingsData[2024] = defaultStandings2024;
                            
                            // Automaticky ulo≈æ defaultn√© d√°ta do Firebase
                            setDoc(doc(db, "web_content", "hall_of_fame"), {
                                standings_2024: defaultStandings2024,
                                seasons: window.currentSeasons
                            }, { merge: true }).then(() => {
                                console.log('‚úÖ Defaultn√© poradie pre 2024 ulo≈æen√© do Firebase');
                            }).catch(err => {
                                console.error('‚ùå Chyba pri ukladan√≠:', err);
                            });
                        } else if (year === 2023) {
                            // Pre rok 2023 vytvor defaultn√© d√°ta ak neexistuj√∫
                            console.log('‚ö†Ô∏è ≈Ωiadne d√°ta v Firebase pre 2023, pou≈æ√≠vam defaultn√©');
                            const defaultStandings2023 = [
                                { name: "Mu≈°ky", points: "109b" },
                                { name: "Guru Team", points: "100b" },
                                { name: "Sprost√°ci", points: "87b" },
                                { name: "Divok√© Pu≈°ky", points: "79b" },
                                { name: "≈Ωol√≠ci", points: "65b" },
                                { name: "Font√°na", points: "57b" },
                                { name: "≈†ugibanda", points: "25b" },
                                { name: "Tuli Tuli", points: "18b" },
                                { name: "Mlad√° Matica", points: "8b" },
                                { name: "Stalaktity", points: "8b" },
                                { name: "L√∫zri", points: "2b" }
                            ];
                            
                            window.standingsData[2023] = defaultStandings2023;
                            
                            // Automaticky ulo≈æ defaultn√© d√°ta do Firebase
                            // Pridaj 2023 do seasons ak tam nie je
                            const updatedSeasons = window.currentSeasons.includes(2023) 
                                ? window.currentSeasons 
                                : [...window.currentSeasons, 2023];
                            
                            setDoc(doc(db, "web_content", "hall_of_fame"), {
                                standings_2023: defaultStandings2023,
                                seasons: updatedSeasons
                            }, { merge: true }).then(() => {
                                console.log('‚úÖ Defaultn√© poradie pre 2023 ulo≈æen√© do Firebase');
                                window.currentSeasons = updatedSeasons;
                            }).catch(err => {
                                console.error('‚ùå Chyba pri ukladan√≠:', err);
                            });
                        } else if (year === 2022) {
                            // Pre rok 2022 vytvor defaultn√© d√°ta ak neexistuj√∫
                            console.log('‚ö†Ô∏è ≈Ωiadne d√°ta v Firebase pre 2022, pou≈æ√≠vam defaultn√©');
                            const defaultStandings2022 = [
                                { name: "No Name", points: "75b" },
                                { name: "Sprost√°ci", points: "67,5b" },
                                { name: "Font√°na", points: "67b" },
                                { name: "Divok√© pu≈°ky", points: "49b" },
                                { name: "Mu≈°ky", points: "43b" },
                                { name: "No T√°√°√°k", points: "35b" },
                                { name: "≈†ugibanda", points: "28b" },
                                { name: "≈Ωol√≠ci", points: "11b" },
                                { name: "Alpha", points: "4b" }
                            ];
                            
                            window.standingsData[2022] = defaultStandings2022;
                            
                            // Automaticky ulo≈æ defaultn√© d√°ta do Firebase
                            // Pridaj 2022 do seasons ak tam nie je
                            const updatedSeasons2022 = window.currentSeasons.includes(2022) 
                                ? window.currentSeasons 
                                : [...window.currentSeasons, 2022];
                            
                            setDoc(doc(db, "web_content", "hall_of_fame"), {
                                standings_2022: defaultStandings2022,
                                seasons: updatedSeasons2022
                            }, { merge: true }).then(() => {
                                console.log('‚úÖ Defaultn√© poradie pre 2022 ulo≈æen√© do Firebase');
                                window.currentSeasons = updatedSeasons2022;
                            }).catch(err => {
                                console.error('‚ùå Chyba pri ukladan√≠:', err);
                            });
                        } else if (year === "2020-2021") {
                            // COVID sez√≥na - ≈æiadne d√°ta, ≈°peci√°lny dizajn
                            console.log('‚ö†Ô∏è COVID-19 sez√≥na 2020-2021 - ≈æiadne v√Ωsledky');
                            window.standingsData[year] = [];
                        } else if (year === "2019-2020") {
                            // Pre rok 2019-2020 PREP√ç≈† star√© d√°ta nov√Ωmi (fin√°lne v√Ωsledky)
                            console.log('üîÑ Aktualizujem fin√°lne v√Ωsledky pre 2019-2020');
                            const finalStandings2019_2020 = [
                                { name: "Sprost√°ci", points: "150b" },
                                { name: "Divok√© Pu≈°ky", points: "130b" },
                                { name: "FC Barcelona", points: "129b" },
                                { name: "Font√°na", points: "122b" },
                                { name: "Gemersko", points: "114b" },
                                { name: "Vakididi", points: "47b" },
                                { name: "Bl√°zniv√© strely", points: "28b" },
                                { name: "Experti", points: "21b" },
                                { name: "Rockeri", points: "20b" },
                                { name: "Kamene", points: "18b" },
                                { name: "Fernetky", points: "10b" },
                                { name: "≈†panielske Mu≈°ky", points: "8b" },
                                { name: "MB", points: "7b" },
                                { name: "DUO", points: "7b" }
                            ];
                            
                            window.standingsData[year] = finalStandings2019_2020;
                            
                            // V≈ΩDY prep√≠≈° Firebase d√°ta nov√Ωmi fin√°lnymi v√Ωsledkami
                            const fieldName2019 = 'standings_2019-2020';
                            setDoc(doc(db, "web_content", "hall_of_fame"), {
                                [fieldName2019]: finalStandings2019_2020,
                                seasons: window.currentSeasons
                            }, { merge: true }).then(() => {
                                console.log('‚úÖ Fin√°lne poradie pre 2019-2020 ulo≈æen√© do Firebase');
                            }).catch(err => {
                                console.error('‚ùå Chyba pri ukladan√≠:', err);
                            });
                        } else if (year === "2018-2019") {
                            // Pre rok 2018-2019 PREP√ç≈† star√© d√°ta nov√Ωmi (fin√°lne v√Ωsledky)
                            console.log('üîÑ Aktualizujem fin√°lne v√Ωsledky pre 2018-2019');
                            const finalStandings2018_2019 = [
                                { name: "Sprost√°ci", points: "145b" },
                                { name: "Starci na chmeli", points: "143b" },
                                { name: "Origin√°ly", points: "124b" },
                                { name: "Divok√© pu≈°ky", points: "117b" },
                                { name: "Zobor", points: "114b" },
                                { name: "Font√°na", points: "97b" },
                                { name: "Gemersko", points: "91b" },
                                { name: "Sekery", points: "14b" },
                                { name: "Blek Panter", points: "12b" },
                                { name: "Slanci", points: "6b" },
                                { name: "Kamene", points: "3b" }
                            ];
                            
                            window.standingsData[year] = finalStandings2018_2019;
                            
                            // V≈ΩDY prep√≠≈° Firebase d√°ta nov√Ωmi fin√°lnymi v√Ωsledkami
                            const fieldName2018 = 'standings_2018-2019';
                            setDoc(doc(db, "web_content", "hall_of_fame"), {
                                [fieldName2018]: finalStandings2018_2019,
                                seasons: window.currentSeasons
                            }, { merge: true }).then(() => {
                                console.log('‚úÖ Fin√°lne poradie pre 2018-2019 ulo≈æen√© do Firebase');
                            }).catch(err => {
                                console.error('‚ùå Chyba pri ukladan√≠:', err);
                            });
                        }
                    });
                } else {
                    console.warn('‚ö†Ô∏è Firebase dokument neexistuje, vytv√°ram defaultn√© d√°ta');
                    const defaultStandings = [
                        { name: "Piƒçi Zla", points: "179b" },
                        { name: "Mu≈°ky", points: "162b" },
                        { name: "Guru Team", points: "141b" },
                        { name: "Sprost√°ci", points: "124b" },
                        { name: "Divok√© Pu≈°ky", points: "123b" },
                        { name: "F√©nixov r√°d", points: "100b" },
                        { name: "STIBU", points: "91b" },
                        { name: "≈Ωol√≠ci", points: "59b" },
                        { name: "Gen Z", points: "50b" },
                        { name: "Font√°na", points: "48b" },
                        { name: "Nev√≠dali", points: "17b" },
                        { name: "Kom√©ty", points: "7b" },
                        { name: "Gruppa ABC", points: "3b" },
                        { name: "Fantastic 5", points: "1b" }
                    ];
                    
                    window.standingsData[2025] = defaultStandings;
                    
                    setDoc(doc(db, "web_content", "hall_of_fame"), {
                        standings_2025: defaultStandings,
                        seasons: window.currentSeasons
                    }, { merge: true });
                }
                
                // Po naƒç√≠tan√≠ d√°t z Firebase vykresli sez√≥ny
                setTimeout(() => {
                    if (typeof window.renderSeasons === 'function') {
                        console.log('üöÄ Vol√°m renderSeasons() s d√°tami:', window.standingsData);
                        window.renderSeasons();
                    } else {
                        console.error('‚ùå renderSeasons() funkcia neexistuje');
                    }
                }, 200);
            });
        }

        loadWebContent();
    </script>

    <!-- Modal pre zv√§ƒç≈°enie obr√°zkov -->
    <div id="imageModal" class="modal" onclick="closeModal()">
        <span class="modal-close">&times;</span>
        <button class="modal-nav modal-prev" onclick="event.stopPropagation(); navigateModal(-1)">‚Äπ</button>
        <button class="modal-nav modal-next" onclick="event.stopPropagation(); navigateModal(1)">‚Ä∫</button>
        <img class="modal-content" id="modalImage" onclick="event.stopPropagation()">
    </div>

    <footer>
        <img src="../logo.png" alt="QuizBrothers Logo" class="footer-logo">
        <div>&copy; 2026 QuizBrothers</div>
    </footer>

    <script src="../admin.js"></script>
</body>
</html>